#include <bits/stdc++.h>

using namespace std;

#define ll long long
#define ld long double
#define all(a) (a).begin(), (a).end()

int main() {

    ll t;
    cin>>t;
    

    
    for(int j = 0; j < t; j ++){
        int n;
        cin>>n;
        vector<int>v;
        for(int i = 0; i < n; i++){
            int x;
            cin>>x;
            v.push_back(x);
        }
        for(int k = 0; k < n; k++){
            int y;
            cin>>y;
            int u = 0,d = 0;
            for(int i = 0; i < y; i++){
                char ch; 
                cin>>ch;
                if(ch == 'U') u++;
                else d++;
            }
            if( d - u == 0)cout<<v[k]<<" ";
            else if(d-u > 0){
                int h = (d-u + v[k]) % 10;
                cout<<h<<" ";
            }
            else {
                int g = (d-u + v[k]) % 10 + 10;
                g %= 10;
                cout<<g<<" ";
            }
        }

        cout<<endl;
    }    

    return 0;
}